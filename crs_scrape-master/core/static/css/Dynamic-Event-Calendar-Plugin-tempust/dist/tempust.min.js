var tempust={dpm:[31,28,31,30,31,30,31,31,30,31,30,31],npm:["january","february","march","april","may","june","july","august","september","october","november","december"],npd:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],sds:function(t){return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()},di:function(t,e,a,d){function n(t,e,a){return new Date(t.getFullYear(),t.getMonth(),(e-a)%7).getDay()}var r,s,o={},p={},i={};(r=new Date(t,e,1)).setMonth(e-1),(s=new Date(t,e,1)).setMonth(e+1);for(l=tempust.dpm[r.getMonth()];6!==n(r,l,a);l--){u=new Date(r.getFullYear(),r.getMonth(),l);o[l]={date:u,e:d?d[tempust.sds(u)]:void 0}}for(l=1;l<=tempust.dpm[e];l++){u=new Date(t,e,l);p[l]={date:u,e:d?d[tempust.sds(u)]:void 0}}for(var l=1;n(s,l,a);l++){var u=new Date(s.getFullYear(),s.getMonth(),l);i[l]={date:u,e:d?d[tempust.sds(u)]:void 0}}return{y:t,m:e,o:a,lmd:o,tmd:p,nmd:i}}};!function(t){var e=function(t,e,a){t.data(e.toString())||t.data(e.toString(),a)},a=function(e){var a=e.children(".tempust"),d=e.data().date,n=e.data().offset,r=a.children(".dates"),s=1,o=tempust.di(d.getFullYear(),d.getMonth(),n,e.data().events);r.html(""),loop=function(e,a){var d=[];for(var n in e){var o=t("<div>").append(n).addClass("day").addClass(a||"").attr("data-date",tempust.sds(e[n].date));r.append(o),e[n].e&&(o.attr("data-event",!0),o.on("click",function(){t("[data-event-date='"+t(this).attr("data-date")+"']").slideToggle()}),d.push({date:tempust.sds(e[n].date),details:e[n].e})),++s>7&&(s=1,d.forEach(function(e){r.append(t("<div>").append(e.details).addClass("event").attr("data-event-date",e.date))}),d=[])}};for(var p=0;p<7;p++)r.append(t("<div class='weekday'>").append(tempust.npd[(p+o.o)%7].slice(0,3)));loop(o.lmd,"inactive"),loop(o.tmd),loop(o.nmd,"inactive")},d=function(d){var n,r,s;e(d,"date",new Date),s=d.data().date,d.data("initialised",!0),n=t("<div class='tempust'>").append(t("<div class='header'>")).append(t("<div class='dates'>")),d.append(n),(r=n.children(".header")).append(t("<select>").addClass("year")).children(".year").on("change",function(){d.data().date.setFullYear(t(this).val()),d.trigger({type:"changeDate",date:d.data().date}),d.trigger({type:"changeYear",date:d.data().date}),a(d)});for(o=1900;o<=2100;o++)r.children(".year").append(t("<option>").append(o).attr("value",o).attr("selected",o===s.getFullYear()));r.append(t("<select>").addClass("month")).children(".month").on("change",function(){d.data().date.setMonth(t(this).val()),d.trigger({type:"changeDate",date:d.data().date}),d.trigger({type:"changeMonth",date:d.data().date}),a(d)});for(var o=0;o<12;o++)r.children(".month").append(t("<option>").append(tempust.npm[o]).attr("value",o).attr("selected",o===s.getMonth()))};t.fn.tempust=function(t,e){var n=this;return"[object Date]"===Object.prototype.toString.call(t)&&(n.data(t),d(n),a(n)),null!==t&&"object"==typeof t&&(n.data(t),d(n),a(n)),"changeDate"===t&&(n.data("date",e),a(n)),"setEvents"===t&&(n.data("events",e),a(n)),n}}(jQuery);